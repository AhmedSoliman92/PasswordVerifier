package passwordVerifier;

import java.util.regex.Pattern;

import passwordExceptions.PasswordShouldBeLargerThanEight_Exception;
import passwordExceptions.PasswordShouldHaveOneLowerCaseAtLeast_Exception;
import passwordExceptions.PasswordShouldHaveOneNumberAtLeast_Exception;
import passwordExceptions.PasswordShouldHaveOneUpperCaseLetterAtLeast_Exception;

	
	public class PasswordVerifier{
		
		public String verify(String password) throws PasswordShouldBeLargerThanEight_Exception,PasswordShouldHaveOneUpperCaseLetterAtLeast_Exception,PasswordShouldHaveOneLowerCaseAtLeast_Exception,PasswordShouldHaveOneNumberAtLeast_Exception {
			if(password==null) {
				throw new IllegalArgumentException("Password should not be null");
			}
			verifyPasswordLargerThanEight(password);
			verifyPasswordHasOneUpperCaseLetterAtLeast(password);
			verifyPasswordHasOneLowerCaseAtLeast(password);
			verifyPasswordHasOneNumberAtLeast(password);
			 return password;
		}

		
		public String verifyPasswordLargerThanEight(String password)throws PasswordShouldBeLargerThanEight_Exception {
			if(password.length()>8) {
				return password;
			}
			throw new PasswordShouldBeLargerThanEight_Exception("Password should be larger than 8 chars");
		}
		
		public String verifyPasswordHasOneUpperCaseLetterAtLeast(String password)throws PasswordShouldHaveOneUpperCaseLetterAtLeast_Exception {
			Pattern upperCasePattern=Pattern.compile("[A-Z]",Pattern.CASE_INSENSITIVE);
			if(upperCasePattern.matcher(password).find()) {
				return password;
			}
			throw new PasswordShouldHaveOneUpperCaseLetterAtLeast_Exception("Password should have one uppercase letter at least");
		}
		
		public String verifyPasswordHasOneLowerCaseAtLeast(String password) throws PasswordShouldHaveOneLowerCaseAtLeast_Exception {
			Pattern lowerCasePattern=Pattern.compile("[a-z]",Pattern.CASE_INSENSITIVE);
			if(lowerCasePattern.matcher(password).find()) {
				return password;
			}
			throw new PasswordShouldHaveOneLowerCaseAtLeast_Exception("Password should have one lowercase letter at least");
		}
		public boolean verifyPasswordHasOneNumberAtLeast(String password) throws PasswordShouldHaveOneNumberAtLeast_Exception {
	        for (char character : password.toCharArray()) {
	            if (Character.isDigit(character)) {
	                return true;
	            }
	        }
	        throw new PasswordShouldHaveOneNumberAtLeast_Exception("The password MUST have minimum a digit case");
	    }
}